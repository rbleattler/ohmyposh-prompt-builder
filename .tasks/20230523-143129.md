---
taskId: 20230523-143129
parent: 20230516-142530
title: Implement Drag and Drop for Segments
status: todo
priority: 3
assignee:
tags:
  - ui
  - dnd
  - editor
---

# Implement Drag and Drop for Segments

## Overview

The drag and drop functionality for reordering segments within a block needs to be restored. This feature is critical for allowing users to visually organize their prompt components without manually editing JSON.

## Acceptance Criteria

- [ ] Implement drag and drop functionality using React DnD
  - [ ] Each segment should be draggable within its parent block
  - [ ] Visual indicators should show potential drop positions
  - [ ] Segments cannot be dragged between different blocks

- [ ] Ensure theme state updates correctly after reordering
  - [ ] The segment order in the theme JSON should reflect the UI changes
  - [ ] The preview should update immediately after reordering

- [ ] Add appropriate animations and visual cues
  - [ ] Drag handles should be visible on segments
  - [ ] Segments should have hover states indicating they can be dragged
  - [ ] Drop zones should be highlighted when a dragged item is over them

## Technical Details

### Implementation Approach

1. Set up React DnD in the project
   - Install `react-dnd` and `react-dnd-html5-backend` packages
   - Configure the DnD context provider in the application

2. Create draggable segment components
   - Wrap segment items in a `DragSource` HOC or use the appropriate hooks
   - Implement drag handlers to manage the dragging state
   - Add visual indicators for dragging state

3. Implement drop targets for segments
   - Create drop zones between segments
   - Handle segment reordering logic when items are dropped
   - Update the theme context with the new segment order

4. Add visual polish
   - Implement smooth animations for dragging
   - Add clear visual indicators for drag states

### Dependencies

- React DnD library
- Theme context for updating segment order
- Existing segment components

## Time Estimate

4-6 hours

## References

- [React DnD Documentation](https://react-dnd.github.io/react-dnd/about)
- [Example implementation of sortable lists](https://react-dnd.github.io/react-dnd/examples/sortable/simple)
